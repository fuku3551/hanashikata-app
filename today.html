<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ”° ä»Šæ—¥ã®ãŠã™ã™ã‚ç·´ç¿’</title>
<link rel="stylesheet" href="style.css">

<style>
.big{font-size:36px;font-weight:900;text-align:center;margin:10px 0;}
.mid{font-size:22px;font-weight:800;text-align:center;margin:6px 0;}
.small{text-align:center;opacity:.8;font-size:14px;}
.highlight{color:#e60033;font-weight:900;}
.kara span{padding:2px 4px;border-radius:6px;}
.kara .active{background:#ffd6d6;}
.kara .done{opacity:.4;}
.center{text-align:center;}
.btn{padding:12px 16px;border-radius:12px;border:none;font-weight:800;}
.primary{background:#0ea5e9;color:#fff;}
</style>
</head>

<body>

<header class="top">
<h1>ğŸ”° ä»Šæ—¥ã®ãŠã™ã™ã‚ç·´ç¿’</h1>
<p><a href="index.html">â† ãƒ›ãƒ¼ãƒ ã¸</a></p>
</header>

<main class="menu">

<div class="card">
<div class="title">ä¸€æœ¬é“ãƒ«ãƒ¼ãƒˆï¼ˆç´„4ã€œ5åˆ†ï¼‰</div>
<div class="desc small">
å‘¼å¸ â†’ èˆŒãƒˆãƒ¬ â†’ æ»‘èˆŒï¼ˆè¡Œåˆ¥ï¼‰â†’ è¨€ã„ã«ãã„10é¸ â†’ 30ç§’ã‚¹ãƒ”ãƒ¼ãƒ
</div>
<div class="center" style="margin-top:10px;">
<button class="btn primary" onclick="startAll()">â–¶ é–‹å§‹</button>
</div>
</div>

<div class="card">
<div id="phase" class="mid">æº–å‚™OK</div>
<div id="display" class="big">00</div>
<div id="sub" class="small">ã‚¹ã‚¿ãƒ¼ãƒˆã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
</div>

</main>

<script>

/* =========================
   å…¨ä½“åˆ¶å¾¡
========================= */

let timer=null;
let karaTimer=null;

function wait(ms){
  return new Promise(res=>setTimeout(res,ms));
}

function setPhase(t){ document.getElementById("phase").textContent=t; }
function setDisplay(t){ document.getElementById("display").innerHTML=t; }
function setSub(t){ document.getElementById("sub").textContent=t; }

/* =========================
   å‘¼å¸ 4-4-8 Ã—3
========================= */

async function breathing(){

setPhase("ğŸ’¨ å‘¼å¸");
for(let round=1; round<=3; round++){

  setSub("ã¯ã„å¸ã£ã¦ã€œ");
  for(let i=1;i<=4;i++){
    setDisplay(i);
    await wait(1000);
  }

  setSub("ã¯ã„æ­¢ã‚ã¦");
  for(let i=1;i<=4;i++){
    setDisplay(i);
    await wait(1000);
  }

  setSub("ã¯ã„åã„ã¦ã€œ ãƒ•ã‚¥ã€œ");
  for(let i=1;i<=8;i++){
    setDisplay(i);
    await wait(1000);
  }

}

}

/* =========================
   èˆŒãƒˆãƒ¬
========================= */

async function tongue(){

setPhase("ğŸ‘… èˆŒãƒˆãƒ¬");
setSub("æ¬¡ã¯èˆŒãƒˆãƒ¬ã§ã™ã€‚å³å›ã‚Š5å›ã—ã¾ã™");
await wait(2000);

for(let i=1;i<=5;i++){
  setDisplay(i);
  await wait(1000);
}

setSub("æ¬¡ã¯å·¦å›ã‚Š5å›ã—ã¾ã™");
await wait(1500);

for(let i=1;i<=5;i++){
  setDisplay(i);
  await wait(1000);
}

}

/* =========================
   ã‚«ãƒ©ã‚ªã‚±å‡¦ç†ï¼ˆæ‹—éŸ³å¯¾å¿œï¼‰
========================= */

function splitText(txt){
const small="ã‚ƒã‚…ã‚‡ããƒã…ã‡ã‰";
let arr=[],buf="";
for(let c of txt){
 if(small.includes(c)){ buf+=c; }
 else{
   if(buf) arr.push(buf);
   buf=c;
 }
}
if(buf) arr.push(buf);
return arr;
}

async function karaoke(text){

setDisplay("");
let container=document.getElementById("display");
container.className="big kara";
container.innerHTML="";

let units=splitText(text);

units.forEach(u=>{
 let sp=document.createElement("span");
 sp.textContent=u;
 container.appendChild(sp);
});

let spans=container.querySelectorAll("span");

for(let i=0;i<spans.length;i++){
 spans[i].classList.add("active");
 await wait(350);
 spans[i].classList.remove("active");
 spans[i].classList.add("done");
}

await wait(500);
container.className="big";
}

/* =========================
   æ»‘èˆŒ è¡Œåˆ¥
========================= */

async function gyou(){

setPhase("ğŸ‘„ æ»‘èˆŒï¼ˆã‚¢ã€œãƒ¯è¡Œï¼‰");
setSub("1èªãšã¤ä¸å¯§ã«ç™ºå£°ã—ã¾ã—ã‚‡ã†");

const lines=[
"ã‚ã„ã†ãˆãŠ",
"ã‹ããã‘ã“",
"ã•ã—ã™ã›ã",
"ãŸã¡ã¤ã¦ã¨",
"ãªã«ã¬ã­ã®",
"ã¯ã²ãµã¸ã»",
"ã¾ã¿ã‚€ã‚ã‚‚",
"ã‚„ã‚†ã‚ˆ",
"ã‚‰ã‚Šã‚‹ã‚Œã‚",
"ã‚ã‚’ã‚“"
];

for(let l of lines){
 await karaoke(l);
}

}

/* =========================
   è¨€ã„ã«ãã„10é¸ï¼ˆrubyä½¿ç”¨ï¼‰
========================= */

async function hard10(){

setPhase("ğŸ“¢ è¨€ã„ã«ãã„ãƒ•ãƒ¬ãƒ¼ã‚º10é¸");

const list=[
"<ruby>æ±äº¬<rt>ã¨ã†ãã‚‡ã†</rt></ruby><ruby>ç‰¹è¨±<rt>ã¨ã£ãã‚‡</rt></ruby><ruby>è¨±å¯å±€<rt>ãã‚‡ã‹ãã‚‡ã</rt></ruby>",
"<ruby>ç”Ÿéº¦<rt>ãªã¾ã‚€ã</rt></ruby> <ruby>ç”Ÿç±³<rt>ãªã¾ã”ã‚</rt></ruby> <ruby>ç”Ÿåµ<rt>ãªã¾ãŸã¾ã”</rt></ruby>",
"<ruby>èµ¤å·»ç´™<rt>ã‚ã‹ã¾ããŒã¿</rt></ruby>",
"<ruby>éš£<rt>ã¨ãªã‚Š</rt></ruby>ã®<ruby>å®¢<rt>ãã‚ƒã</rt></ruby>ã¯ã‚ˆã<ruby>æŸ¿<rt>ã‹ã</rt></ruby><ruby>é£Ÿ<rt>ã</rt></ruby>ã†<ruby>å®¢<rt>ãã‚ƒã</rt></ruby>",
"<ruby>æ‰“è€…<rt>ã ã—ã‚ƒ</rt></ruby><ruby>èµ°è€…<rt>ãã†ã—ã‚ƒ</rt></ruby><ruby>å‹è€…<rt>ã—ã‚‡ã†ã—ã‚ƒ</rt></ruby>",
"<ruby>é­”è¡“å¸«<rt>ã¾ã˜ã‚…ã¤ã—</rt></ruby><ruby>æ‰‹è¡“ä¸­<rt>ã—ã‚…ã˜ã‚…ã¤ã¡ã‚…ã†</rt></ruby>",
"<ruby>æ—…å®¢æ©Ÿ<rt>ã‚Šã‚‡ã‹ã£ã</rt></ruby>",
"<ruby>æœ€çµ‚æ‰‹æ®µ<rt>ã•ã„ã—ã‚…ã†ã—ã‚…ã ã‚“</rt></ruby>",
"<ruby>æ”¯ç¤¾<rt>ã—ã—ã‚ƒ</rt></ruby><ruby>è¦–å¯Ÿ<rt>ã—ã•ã¤</rt></ruby>",
"<ruby>ç‰¹æ€¥åˆ—è»Š<rt>ã¨ã£ãã‚…ã†ã‚Œã£ã—ã‚ƒ</rt></ruby>"
];

for(let item of list){
 await karaoke(item.replace(/<[^>]+>/g,""));
}

}

/* =========================
   30ç§’ã‚¹ãƒ”ãƒ¼ãƒ
========================= */

async function speech(){

setPhase("ğŸ¤ 30ç§’ã‚¹ãƒ”ãƒ¼ãƒ");

const topics=[
"ã‚ãªãŸã®å¥½ããªé£Ÿã¹ç‰©",
"ã‚ãªãŸã®å«Œã„ãªé£Ÿã¹ç‰©",
"ã‚ãªãŸã®å‡ºèº«åœ°",
"æ˜”ã‚„ã£ã¦ã„ãŸã‚¹ãƒãƒ¼ãƒ„",
"ä»Šä½ã‚“ã§ã„ã‚‹å ´æ‰€",
"ã‚ãªãŸã®ä»•äº‹",
"ã“ã‚Œã‹ã‚‰æŒ‘æˆ¦ã—ãŸã„äº‹",
"æœ€è¿‘ã†ã‚Œã—ã‹ã£ãŸäº‹",
"æœ€è¿‘å­¦ã‚“ã äº‹",
"ã‚ãªãŸã®å¼·ã¿",
"ã‚ãªãŸã®å¼±ã¿",
"å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ä¾¡å€¤è¦³",
"å­ä¾›ã®é ƒã®å¤¢",
"ä»Šæ¬²ã—ã„ã‚‚ã®",
"æœ€è¿‘ãƒãƒã£ã¦ã„ã‚‹äº‹",
"å°Šæ•¬ã™ã‚‹äºº",
"æ„Ÿè¬ã—ã¦ã„ã‚‹äºº",
"æŒ‘æˆ¦ä¸­ã®äº‹",
"è‡ªåˆ†ã‚’ä¸€è¨€ã§è¡¨ã™ã¨",
"æœ€è¿‘ã®å°ã•ãªæˆåŠŸ"
];

let topic=topics[Math.floor(Math.random()*topics.length)];

setSub(topic);
await wait(2000);

for(let i=30;i>=0;i--){
 setDisplay(i);
 await wait(1000);
}

}

/* =========================
   å…¨ä½“ã‚¹ã‚¿ãƒ¼ãƒˆ
========================= */

async function startAll(){

await breathing();
await wait(2000);

await tongue();
await wait(2000);

await gyou();
await wait(2000);

await hard10();
await wait(2000);

await speech();

setPhase("âœ¨ ãŠç–²ã‚Œæ§˜ã§ã—ãŸ");
setDisplay("ğŸ˜Š");
setSub("ã“ã®èª¿å­ã§ç„¦ã‚‰ãšç¶šã‘ã¦ã„ãã¾ã—ã‚‡ã†â™ª");

}

</script>

</body>
</html>