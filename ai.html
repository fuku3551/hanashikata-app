<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AIè©•ä¾¡ï¼ˆã‚„ã•ã—ã„ç·åˆè©•ä¾¡ï¼‰</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* æ—¢å­˜ã®style.cssã‚’å£Šã•ãªã„ãŸã‚ã®æœ€ä½é™ã®è£œåŠ© */
    .btnRow { display:flex; gap:10px; flex-wrap:wrap; }
    textarea { width:100%; min-height:160px; padding:12px; border-radius:12px; border:1px solid #ddd; }
    .resultBox { white-space: pre-wrap; line-height: 1.9; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid #ddd; font-size:14px; margin:4px 6px 0 0; }
    .small { font-size: 14px; opacity: 0.9; }
    button { padding:12px 14px; border-radius:12px; border:1px solid #ddd; background:#fff; }
    button.primary { border: none; background: #0ea5e9; color: #fff; }
  </style>
</head>

<body>
  <header class="top">
    <h1>ğŸ§  AIè©•ä¾¡ï¼ˆã‚„ã•ã—ã„ç·åˆè©•ä¾¡ï¼‰</h1>
    <p class="sub">PREPã«ç¸›ã‚‰ã‚Œãšã€è‡ªç„¶ãªè¨€ã„å›ã—ã‚‚è©•ä¾¡ã—ã¾ã™</p>
    <p><a href="index.html">â† ãƒ›ãƒ¼ãƒ ã¸æˆ»ã‚‹</a></p>
  </header>

  <main class="menu">
    <div class="card" style="display:block;">
      <div class="title">ã‚¹ãƒ”ãƒ¼ãƒæœ¬æ–‡ã‚’å…¥åŠ›</div>
      <div class="desc">
        <textarea id="speechText" placeholder="ã“ã“ã«ã‚¹ãƒ”ãƒ¼ãƒã‚’æ›¸ã„ã¦ãã ã•ã„ï¼ˆè©±ã—ãŸå†…å®¹ã®ãƒ¡ãƒ¢ã§ã‚‚OKï¼‰"></textarea>

        <div class="btnRow" style="margin-top:10px;">
          <button class="primary" onclick="runEvaluation()">AIè©•ä¾¡ã™ã‚‹</button>
          <button onclick="insertSample()">ã‚µãƒ³ãƒ—ãƒ«æŒ¿å…¥</button>
          <button onclick="clearText()">ã‚¯ãƒªã‚¢</button>
        </div>

        <div class="small" style="margin-top:10px;">
          â€»è©•ä¾¡ã¯ã€Œæ¸›ç‚¹æ–¹å¼ã€ã§ã¯ãªãã€è‰¯ã„ç‚¹ã‚’è¦‹ã¤ã‘ã¦ä¼¸ã°ã™æ–¹å¼ã§ã™ã€‚<br>
          â€»ã€Œçµè«–ãƒ»ç†ç”±ãƒ»ä¾‹ãˆã°ã€ãªã©ã®å˜èªãŒãã®ã¾ã¾å…¥ã£ã¦ã„ãªãã¦ã‚‚ã€ä¼¼ãŸè¡¨ç¾ãªã‚‰OKã«ã—ã¦ã„ã¾ã™ã€‚
        </div>
      </div>
    </div>

    <div class="card" style="display:block;">
      <div class="title">è©•ä¾¡çµæœ</div>
      <div class="desc">
        <div id="badges"></div>
        <div id="result" class="resultBox" style="margin-top:10px;">ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
      </div>
    </div>

  </main>

<script>
/* =========================================================
   ã‚„ã•ã—ã„ç·åˆè©•ä¾¡ï¼ˆæŸ”è»Ÿç‰ˆï¼‰
   - PREPå¿…é ˆã§ã¯ãªãã€ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã§ã‚‚åŠ ç‚¹
   - è‰¯ã„ç‚¹ã‚’å„ªå…ˆã—ã¦æç¤º
   - æ”¹å–„ç‚¹ã¯æœ€å¤§1ã¤ï¼ˆå„ªã—ãï¼‰
   ========================================================= */

function gentleEvaluate(text){
  // æ­£è¦åŒ–
  const raw = (text || "").trim();
  const t = raw
    .replace(/\r\n/g, "\n")
    .replace(/\n{3,}/g, "\n\n")
    .trim();

  // æ–‡å­—ãŒå°‘ãªã™ãã‚‹å ´åˆ
  if(t.length < 10){
    return {
      score: 60,
      badges: ["å…¥åŠ›ãŒçŸ­ã‚"],
      message:
`ğŸŒŸ ç·åˆè©•ä¾¡ï¼š60ç‚¹

çŸ­ã„ãªãŒã‚‰ã‚‚ã€è©±ãã†ã¨ã™ã‚‹å§¿å‹¢ãŒã¨ã¦ã‚‚è‰¯ã„ã§ã™ã€‚

ã‚‚ã†1ã€œ2æ–‡ã ã‘è¶³ã—ã¦ã€
ã€Œä½•ã‚’ä¼ãˆãŸã„ã‹ï¼ˆçµè«–ï¼‰ã€ã‹ã€Œä¸€ç•ªå°è±¡ã«æ®‹ã£ãŸã“ã¨ã€ã‚’å…¥ã‚Œã‚‹ã¨ã€
ãã£ã¨ä¼ã‚ã‚Šã‚„ã™ããªã‚Šã¾ã™ğŸ˜Š`
    };
  }

  let score = 60; // æœ€ä½ä¿è¨¼ç‚¹
  const goodPoints = [];
  const badges = [];
  const advice = [];

  // æŸ”è»Ÿåˆ¤å®šç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆPREPå›ºå®šã§ã¯ãªãã€ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã§ã‚‚æ‹¾ã†ï¼‰
  const conclusion = [
    "çµè«–","è¦ã™ã‚‹ã«","ã¤ã¾ã‚Š","ä¸€è¨€ã§ã„ã†ã¨","ç§ã®è€ƒãˆã¯","åƒ•ã®è€ƒãˆã¯","ç§ã¯","åƒ•ã¯",
    "å¤§äº‹ãªã®ã¯","é‡è¦ãªã®ã¯","ãƒã‚¤ãƒ³ãƒˆã¯","çµå±€","ä¸€ç•ªè¨€ã„ãŸã„ã®ã¯"
  ];

  const reason = [
    "ãªãœãªã‚‰","ç†ç”±","èƒŒæ™¯","ã¨ã„ã†ã®ã‚‚","ãªãœã‹ã¨ã„ã†ã¨","ã ã‹ã‚‰ã“ã","ãªã®ã§",
    "ã€œã‹ã‚‰","ã€œãŸã‚","ã€œãŒã‚ã£ã¦"
  ];

  const example = [
    "ä¾‹ãˆã°","ãŸã¨ãˆã°","å®Ÿéš›ã«","ã“ã®å‰","ä»¥å‰","å…ˆæ—¥","å…·ä½“çš„ã«","ä½“é¨“ã¨ã—ã¦","ãŸã¨ãˆã‚‹ã¨",
    "ã“ã‚“ãªã“ã¨ãŒã‚ã£ã¦","ã€œã®ã¨ã"
  ];

  const summary = [
    "ã¾ã¨ã‚ã‚‹ã¨","çµè«–ã¨ã—ã¦","æœ€å¾Œã«","ã ã‹ã‚‰","ã¤ã¾ã‚Š","ãªã®ã§","ã¨ã„ã†ã‚ã‘ã§","è¦ã¯",
    "ä»Šå¾Œã¯","æ¬¡ã¯","ã“ã‚Œã‹ã‚‰"
  ];

  // æ–‡ç« æ§‹é€ ãƒã‚§ãƒƒã‚¯ï¼ˆã‚ãã¾ã§åŠ ç‚¹ï¼‰
  if(conclusion.some(w => t.includes(w))){
    score += 10;
    goodPoints.push("ãƒ†ãƒ¼ãƒï¼ˆä¸»å¼µï¼‰ãŒã¯ã£ãã‚Šã—ã¦ã„ã¾ã—ãŸ");
    badges.push("ãƒ†ãƒ¼ãƒæ˜ç¢º");
  }

  if(reason.some(w => t.includes(w))){
    score += 10;
    goodPoints.push("ç†ç”±ã‚„èƒŒæ™¯ãŒä¼ã‚ã£ã¦ç´å¾—ã—ã‚„ã™ã‹ã£ãŸã§ã™");
    badges.push("ç´å¾—æ„Ÿ");
  }

  if(example.some(w => t.includes(w))){
    score += 10;
    goodPoints.push("å…·ä½“ä¾‹ãŒã‚ã‚Šã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ã‹ã£ãŸã§ã™");
    badges.push("å…·ä½“æ€§");
  }

  if(summary.some(w => t.includes(w))){
    score += 10;
    goodPoints.push("æœ€å¾Œã®ç· ã‚ãƒ»ã¾ã¨ã‚ãŒè‰¯ãã€ä½™éŸ»ãŒæ®‹ã‚Šã¾ã—ãŸ");
    badges.push("ç· ã‚ãŒè‰¯ã„");
  }

  // åˆ†é‡ï¼ˆå¤šã„ã»ã©å¿…ãšè‰¯ã„ã§ã¯ãªã„ãŒã€ä¸€å®šä»¥ä¸Šã¯åŠªåŠ›ã¨ã—ã¦åŠ ç‚¹ï¼‰
  if(t.length > 120){
    score += 5;
    goodPoints.push("å†…å®¹ã‚’ã—ã£ã‹ã‚Šè€ƒãˆã¦è©±ã—ã¦ã„ã‚‹ã®ãŒä¼ã‚ã‚Šã¾ã—ãŸ");
    badges.push("å†…å®¹å……å®Ÿ");
  }

  // æ„Ÿæƒ…ãƒ»ç†±é‡ï¼ˆè‡ªå·±è‚¯å®šæ„Ÿã‚’ä¸Šã’ã‚‹ãƒã‚¤ãƒ³ãƒˆï¼‰
  const emotionWords = ["å¬‰ã—ã„","æ¥½ã—ã„","æ‚”ã—ã„","æ‚²ã—ã„","æ€–ã„","æ„Ÿå‹•","é©šã„ãŸ","ãƒ¯ã‚¯ãƒ¯ã‚¯","ãƒ¢ãƒ¤ãƒ¢ãƒ¤","è…¹ãŒç«‹ã£ãŸ","ã»ã£ã¨ã—ãŸ"];
  if(emotionWords.some(w => t.includes(w))){
    score += 5;
    goodPoints.push("æ„Ÿæƒ…ãŒå…¥ã£ã¦ã„ã¦ã€èãæ‰‹ã®å¿ƒã«å±Šãã‚„ã™ã„è©±ã—æ–¹ã§ã—ãŸ");
    badges.push("æ„Ÿæƒ…ãŒä¼ã‚ã‚‹");
  }

  // èãæ‰‹ã¸ã®é…æ…®
  const listenerWords = ["ã‚ãªãŸ","ã¿ãªã•ã‚“","çš†ã•ã‚“","ç›¸æ‰‹","èãäºº","ä¼ãˆãŸã„","ãŠã™ã™ã‚","å…±æœ‰"];
  if(listenerWords.some(w => t.includes(w))){
    score += 5;
    goodPoints.push("èãæ‰‹ã‚’æ„è­˜ã—ãŸè¨€è‘‰é¸ã³ãŒã§ãã¦ã„ã¾ã—ãŸ");
    badges.push("èãæ‰‹ç›®ç·š");
  }

  // æ”¹å–„ææ¡ˆã¯æœ€å¤§1ã¤ï¼šè¶³ã‚Šãªã„è¦ç´ ã‚’å„ªå…ˆåº¦ã§
  const hasConclusion = conclusion.some(w => t.includes(w));
  const hasReason = reason.some(w => t.includes(w));
  const hasExample = example.some(w => t.includes(w));
  const hasSummary = summary.some(w => t.includes(w));

  // å„ªå…ˆåº¦ï¼šå…·ä½“ä¾‹ â†’ ã¾ã¨ã‚ â†’ ç†ç”± â†’ çµè«–
  if(!hasExample){
    advice.push("å…·ä½“ä¾‹ã‚’ã€Œ1ã¤ã ã‘ã€å…¥ã‚Œã‚‹ã¨ã€ã•ã‚‰ã«ã‚°ãƒƒã¨ä¼ã‚ã‚Šã¾ã™ï¼ˆä¾‹ï¼šãã®æ™‚ã®å ´é¢ï¼å‡ºæ¥äº‹ï¼‰");
  } else if(!hasSummary){
    advice.push("æœ€å¾Œã«ä¸€è¨€ã ã‘ã€Œã¾ã¨ã‚ã€ã‚’ç½®ãã¨ã€èãæ‰‹ã®è¨˜æ†¶ã«æ®‹ã‚Šã‚„ã™ããªã‚Šã¾ã™");
  } else if(!hasReason){
    advice.push("ç†ç”±ã‚’ä¸€è¨€è¶³ã™ã¨èª¬å¾—åŠ›ãŒå¢—ã—ã¾ã™ï¼ˆä¾‹ï¼šãªãœãã†æ„Ÿã˜ãŸã‹ï¼‰");
  } else if(!hasConclusion){
    advice.push("å†’é ­ã‹æœ€å¾Œã«ã€Œä¸€ç•ªä¼ãˆãŸã„çµè«–ã€ã‚’ä¸€è¨€ç½®ãã¨ã€ã•ã‚‰ã«åˆ†ã‹ã‚Šã‚„ã™ããªã‚Šã¾ã™");
  }

  // ãƒ©ãƒ³ãƒ€ãƒ è¤’ã‚ï¼ˆè‰¯ã„ç‚¹ãŒè¤‡æ•°ã‚ã‚Œã°ãƒ©ãƒ³ãƒ€ãƒ ã§1ã¤æŠœãï¼‰
  const praise = goodPoints.length
    ? goodPoints[Math.floor(Math.random() * goodPoints.length)]
    : "å‰å‘ãã«è©±ãã†ã¨ã—ã¦ã„ã‚‹å§¿å‹¢ãŒã¨ã¦ã‚‚è‰¯ã„ã§ã™";

  const improve = advice.length ? advice[0] : "ä»Šã®èª¿å­ã§ç¶šã‘ã¦ã„ãã¾ã—ã‚‡ã†";

  // ã‚¹ã‚³ã‚¢ä¸Šé™
  score = Math.min(score, 100);

  // ãƒãƒƒã‚¸ãŒç©ºãªã‚‰æœ€ä½1ã¤
  const finalBadges = badges.length ? badges : ["å‰å‘ã"];

  return {
    score,
    badges: finalBadges,
    message:
`ğŸŒŸ ç·åˆè©•ä¾¡ï¼š${score}ç‚¹

ã¨ã¦ã‚‚è‰¯ã„ã‚¹ãƒ”ãƒ¼ãƒã§ã—ãŸã€‚

ç‰¹ã«ã€Œ${praise}ã€ç‚¹ãŒç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚

ğŸ’¡ ã•ã‚‰ã«è‰¯ãã™ã‚‹ãªã‚‰ï¼š
${improve}

ã“ã‚Œã‹ã‚‰ã‚‚è‡ªä¿¡ã‚’æŒã£ã¦è©±ã—ã¦å¤§ä¸ˆå¤«ã§ã™ğŸ˜Š`
  };
}

// UIç”¨
function runEvaluation(){
  const text = document.getElementById("speechText").value;
  const res = gentleEvaluate(text);

  // ãƒãƒƒã‚¸è¡¨ç¤º
  const badgesEl = document.getElementById("badges");
  badgesEl.innerHTML = "";
  (res.badges || []).forEach(b => {
    const span = document.createElement("span");
    span.className = "pill";
    span.textContent = b;
    badgesEl.appendChild(span);
  });

  document.getElementById("result").textContent = res.message;
}

function clearText(){
  document.getElementById("speechText").value = "";
  document.getElementById("badges").innerHTML = "";
  document.getElementById("result").textContent = "ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚";
}

function insertSample(){
  document.getElementById("speechText").value =
`æœ€è¿‘ã†ã‚Œã—ã‹ã£ãŸã“ã¨ã‚’è©±ã—ã¾ã™ã€‚
ã“ã®å‰ã€ä»•äº‹ã§æ–°äººã•ã‚“ãŒã€Œç¦ç”°ã•ã‚“ã®èª¬æ˜ã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€ã¨è¨€ã£ã¦ãã‚Œã¾ã—ãŸã€‚
ã¨ã„ã†ã®ã‚‚ã€ç§ã¯æœ€åˆã«ç›¸æ‰‹ã®çŠ¶æ³ã‚’èã„ã¦ã‹ã‚‰èª¬æ˜ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚
ä¾‹ãˆã°ã€æ‰‹é †ã‚’ä¸€æ°—ã«è¨€ã†ã®ã§ã¯ãªãã€ä»Šã®ä¸å®‰ã‚’ä¸€ã¤ãšã¤è§£æ¶ˆã™ã‚‹å½¢ã«ã—ã¾ã—ãŸã€‚
ãªã®ã§ã€ã“ã‚Œã‹ã‚‰ã‚‚ç›¸æ‰‹ç›®ç·šã§ä¼ãˆã‚‹ã“ã¨ã‚’å¤§äº‹ã«ã—ãŸã„ã§ã™ã€‚`;
  runEvaluation();
}
</script>

</body>
</html>